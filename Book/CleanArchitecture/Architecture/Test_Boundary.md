# 테스트 경계

> 테스트는 시스템의 일부이며 아키텍처에도 관여한다.

## 시스템 컴포넌트인 테스트

> 아키텍처 관점에서 모든 테스트는 동일하다.
> 테스트는 의존성 규칙을 따르는데, 테스트는 세부적이며 구체적인 것으로 의존성은 항상 테스트 대상이 되는 코드를 향한다.

즉 테스트는 아키텍처의 가장 바깥쪽 원에 있으며, 테스트는 독립적으로 배포 가능하다.
테스트의 역할은 운영이 아니라 개발을 지원하는 데 있다.

## 테스트를 고려한 설계

테스트가 시스템의 설계와 잘 통합되지 않으면 테스트는 깨지기 쉬워지고 시스템은 뻣뻣해져서 변경하기 어려워진다.

<aside>
💡 테스트가 시스템 설계 밖에 있으면 시스템이 변경될 때 테스트가 망가진다.
깨지기 쉬운 테스트는 시스템을 뻣뻣하게 만든다.

</aside>

- 변동성이 있는 것에 의존하지 말라

## 테스트 API

- 설명 : 테스트가 모든 업무 규칙을 검증하는 데 사용할 수 있도록 특화된 API를 만든다.
  - 시스템을 테스트 가능한 특정 상태로 강제하는 강력한 힘
  - 이 API는 사용자 인터페이스가 사용하는 인터랙터와 인터페이스 어댑터들의 상위 집합
- 목적 : 테스트를 애플리케이션으로부터 분리할 목적
  - 역할은 애플리케이션의 구조를 테스트로부터 숨기는 것
  - 상용 코드를 리팩터링하거나 진화시키더라도 테스트에 영향을 주지 않는다.
  - 테스트를 리팩터링하거나 진화시킬 때도 상용 코드에 전혀 영향을 주지 않는다.
- 구조적 결합
  - 테스트 결합 중 가장 강하며 가장 은밀하게 퍼져 나가는 유형
  - 테스트는 구체적이고 특화된 형태로 변하며, 상용 코드는 더 추상적이고 범용적인 형태로 변하는데
    - 구조적 결합이 강하면 필수적인 진화 과정을 방해/지연 시키며
    - 상용 코드의 범용성과 유연성이 충분히 좋아지지 못하게 막는다.
- 보안
  - 테스트 API가 지닌 강력한 힘을 운영 시스템에 배포하면 위험할 수 있다.
  - 테스트 API 자체와 위험한 구현부는 독립적으로 배포할 수 있는 컴포넌트로 분리해야 한다.

## 결론

테스트는 시스템의 일부다.

따라서 테스트에 기대하는 안정성과 회귀의 이점을 얻으려면 테스트는 잘 설계되어야만 한다.
